<xml xmlns="http://www.w3.org/1999/xhtml"><block type="workflow_start" id="b8y9fJggqk+VoJzGC-cI" deletable="false" x="190" y="50"><field name="name">kilroy.ui_agent_template/chat_agent/set_config</field><field name="version">1</field><field name="description"></field><field name="interactive">FALSE</field><field name="clean_up">TRUE</field><value name="OUTPUTS"><block type="process_variable_all" id=")8}lLnnP].uS=v4cs,!e"><mutation variable_count="4"></mutation><value name="INPUT0"><block type="process_variable" id="z$!_AtJ2v`qR7aH~oD1a"><field name="process_variable_val">ta_.*</field></block></value><value name="INPUT1"><block type="process_variable" id="Q|Ge_@d6{bX{;]hv%`y}"><field name="process_variable_val">wf_.*</field></block></value><value name="INPUT2"><block type="process_variable" id="dI_HrE%oB|#ViXo;Z`MP"><field name="process_variable_val">inject_.*</field></block></value><value name="INPUT3"><block type="process_variable" id="$?Cwgswu_2$g^a#R7zzR"><field name="process_variable_val">ex_.*</field></block></value></block></value><next><block type="step_group" id="@5#DWeAnwxT4Tf3(T2xd"><field name="role">system</field><field name="timer">24</field><field name="interactive">FALSE</field><field name="can_terminate">FALSE</field><field name="message"></field><statement name="success"><block type="comment" id="c*Z{*5xA0NXJNny=%WO%"><field name="comment">clone webhook_args to ta_config</field><next><block type="set_var_to" id="o~S*;ddzXOS_?-?tGa$f"><field name="var_name">tconfig</field><value name="var_expr"><block type="var_json_stringify" id="~%A:X0,_|L1vPud(9=~/"><field name="formatted">FALSE</field><value name="json"><block type="var_variable" id="JJFt{=HL9I001tC9[KIk"><field name="var_name">webhook_args</field></block></value></block></value><next><block type="set_var_to" id="%%.10UI1vY(%RH_F6s0Q"><field name="var_name">ta_config</field><value name="var_expr"><block type="var_json_parse" id="9MdlPqX]T4ti:e[W3~I+"><value name="json"><block type="var_variable" id="~ji{0A!GeRHH*U6.u7D*"><field name="var_name">tconfig</field></block></value></block></value><next><block type="set_var_to" id="byQ@FiFMiAZ+.=[[HFMd"><field name="var_name">ex_style</field><value name="var_expr"><block type="var_object" id="iDxefa=X#qJ`bJK-UzY5"><field name="obj_name">ta_config</field><field name="field_name">agent_style</field></block></value><next><block type="trigger_pd" id="q/RI=tP_bZL:Yu$mC5pp"><field name="pd_id">${process_diagram_id}</field><field name="trigger_name">set_style</field><field name="synchronous">TRUE</field><field name="copyOutputs">TRUE</field><field name="args">{"ex_style":"${ex_style}"}</field><next><block type="comment" id="-(FQi3M!s6QMv^vDGWow"><field name="comment">save the swarm info in case we need to leave/join new swarms</field><next><block type="set_var_to" id="y|ZJHqUCPuN`|,K%)VE}"><field name="var_name">old_rec_swarm</field><value name="var_expr"><block type="var_variable" id="Xk]_w:I%/Ykm`i5)lsZg"><field name="var_name">ta_rec_swarm</field></block></value><next><block type="set_var_to" id="U7w,S*r[172pI_$MjsCS"><field name="var_name">old_send_swarm</field><value name="var_expr"><block type="var_variable" id="wpo4V.CYv?zoh}Ms9LzO"><field name="var_name">ta_send_swarm</field></block></value><next><block type="comment" id="h-S$j8+xowwJL%{@jgG-"><field name="comment">copy some values to individual vars</field><next><block type="set_var_to" id="q7c6[wU4SSwz^[QJ:7XO"><field name="var_name">ta_agent_name</field><value name="var_expr"><block type="var_object" id="FvzC*|fK0W=HNrNs!7SJ"><field name="obj_name">ta_config</field><field name="field_name">agent_name</field></block></value><next><block type="set_var_to" id="qU[)@Ny5y;|w-=3-]v_m"><field name="var_name">ta_agent_from</field><value name="var_expr"><block type="var_object" id="yR}mMR5JNWER.PA$`V{["><field name="obj_name">ta_config</field><field name="field_name">agent_from</field></block></value><next><block type="set_var_to" id="Cjfea^W0!sUbiq)6lIfm"><field name="var_name">ta_desc</field><value name="var_expr"><block type="var_object" id="Wi6X*7s9w}=mz_EtKPCB"><field name="obj_name">ta_config</field><field name="field_name">agent_desc</field></block></value><next><block type="set_var_to" id="n}Spyy1RD-@z6uw+]UQQ"><field name="var_name">ta_rec_swarm</field><value name="var_expr"><block type="var_object" id="zx~{B|0Obk2+0trhN}_3"><field name="obj_name">ta_config</field><field name="field_name">agent_rec_swarm</field></block></value><next><block type="set_var_to" id="YEfm{wOPK8%qY`coy[kE"><field name="var_name">ta_send_swarm</field><value name="var_expr"><block type="var_object" id="_.=9Qq4$KA%@9THl%#f7"><field name="obj_name">ta_config</field><field name="field_name">agent_send_swarm</field></block></value><next><block type="set_var_to" id="HXFT85d1GT}1W0]3ZG7@"><field name="var_name">ta_desc_len</field><value name="var_expr"><block type="array_length" id="Yy^GVnJ=l+RTlG3SX%yY"><field name="array_name">ta_desc</field></block></value><next><block type="if_then_else" id="xX,*nqwArf@7P|!G!_a6"><field name="condition">${ta_desc_len} &gt; 0</field><statement name="else"><block type="set_value" id="7h|8q)-/rik`Y5+9VK_y"><field name="variable">ta_desc</field><field name="value">Viewer Agent</field></block></statement><next><block type="set_var_to" id="ehj/0Dm`1MSq)2^/{Jr~"><field name="var_name">wf_agent_name</field><value name="var_expr"><block type="var_object" id="4*}~[|V$npqU:|KuwM5s"><field name="obj_name">ta_config</field><field name="field_name">wf_agent_name</field></block></value><next><block type="set_var_to" id="lTrgblVc4%b:l#Y=d_k%"><field name="var_name">wf_username</field><value name="var_expr"><block type="var_object" id="`%c5.Rn5VL!hTz[?R^##"><field name="obj_name">ta_config</field><field name="field_name">wf_username</field></block></value><next><block type="set_var_to" id="UQb_5NdDB]Et.cX#QX%m"><field name="var_name">wf_webhook_args</field><value name="var_expr"><block type="var_object" id="CcVkB0X)~V@ihFOl5YSO"><field name="obj_name">ta_config</field><field name="field_name">wf_webhook_args</field></block></value><next><block type="set_var_to" id="_fInpqb2/CCY:+YrL$M}"><field name="var_name">wha</field><value name="var_expr"><block type="var_json_parse" id="qin3M]B%(GgHEY0Tiobe"><value name="json"><block type="var_variable" id="HAJnX%Sgp7ioo$YR,oga"><field name="var_name">wf_webhook_args</field></block></value></block></value><next><block type="set_var_to" id="lHEt+FJ]{bG$q63t*3Ds"><field name="var_name">wf_use_markdown</field><value name="var_expr"><block type="var_object" id="bL`@{JDg~})9B$kwFq0o"><field name="obj_name">wha</field><field name="field_name">markdown</field></block></value><next><block type="if_then_else" id="xQa^f/5Qecmf(]w3U]h0"><field name="condition">"${wf_use_markdown}" !== "true"</field><statement name="then"><block type="set_var_to" id="#%Mo1@{LV6h(t=N.EyoC"><field name="var_name">wf_use_markdown</field><value name="var_expr"><block type="var_false" id="]wP?wdRcvYOGC9!@6?@7"></block></value></block></statement><next><block type="set_var_to" id="7~_DE3S(rS!ez0GUAudV"><field name="var_name">wf_use_darkmode</field><value name="var_expr"><block type="var_object" id="%G]44C/hQk|N7^QYYcb."><field name="obj_name">wha</field><field name="field_name">darkmode</field></block></value><next><block type="if_then_else" id="Tm-_avtUKJja.AI?l^`$"><field name="condition">"${wf_use_darkmode}" !== "false"</field><statement name="then"><block type="set_var_to" id="l70wEA=vSRnYow?8UcsD"><field name="var_name">wf_use_darkmode</field><value name="var_expr"><block type="var_true" id="}(S~w:HX63ju|Hn;+%B3"></block></value></block></statement><next><block type="set_var_to" id="jc6fw;Yv|iG|b[pLc}N^"><field name="var_name">wf_page_mode</field><value name="var_expr"><block type="var_object" id="q.]rC~??viR9tEJnXM{!"><field name="obj_name">wha</field><field name="field_name">page_mode</field></block></value><next><block type="set_var_to" id="AaQ!`7;Vflq+p/SD9*$,"><field name="var_name">inject_agent_from</field><value name="var_expr"><block type="var_object" id="%bTIg#?cmYxS6@I{(%nS"><field name="obj_name">ta_config</field><field name="field_name">ta_agent_from</field></block></value><next><block type="set_var_to" id="=KiJ]v#++xJ7$MF7^NAC"><field name="var_name">inject_agent_name</field><value name="var_expr"><block type="var_object" id="?t=XXTyU-pF{g{?u%?qZ"><field name="obj_name">ta_config</field><field name="field_name">wf_agent_name</field></block></value><next><block type="set_var_to" id="V4ThyU2hoaB@yFww]k3^"><field name="var_name">inject_username</field><value name="var_expr"><block type="var_object" id="_HxkQVRvhN.g9c@H:0w!"><field name="obj_name">ta_config</field><field name="field_name">wf_username</field></block></value><next><block type="set_var_to" id="t%3b5Oz/#N6%^.@LoXfX"><field name="var_name">inject_pub_swarm</field><value name="var_expr"><block type="var_variable" id="~W2{sM$x9!5{whwcusB$"><field name="var_name">ta_send_swarm</field></block></value><next><block type="set_var_to" id="Y5,zz$6nl1F,^o}6g8q?"><field name="var_name">inject_sub_swarm</field><value name="var_expr"><block type="var_variable" id="(hWJgp/i?ypI3!EEtu`w"><field name="var_name">ta_rec_swarm</field></block></value><next><block type="set_var_to" id="7xke=q^pRCGQa|w;5vSP"><field name="var_name">ta_width</field><value name="var_expr"><block type="var_object" id="W|i/8PA[X.lP.MbLH%#g"><field name="obj_name">ta_config</field><field name="field_name">agent_width</field></block></value><next><block type="set_var_to" id="|qh]66|[{NJ1dy/3xGBc"><field name="var_name">ta_height</field><value name="var_expr"><block type="var_object" id="]*eij:jVccTh^Tu84GAN"><field name="obj_name">ta_config</field><field name="field_name">agent_height</field></block></value><next><block type="set_var_to" id="isq]t/9Y_a?@Mz@5CFd_"><field name="var_name">ta_height</field><value name="var_expr"><block type="var_math" id="i_c]T`XbMg9y,aqyoBsr"><field name="operator">subtract</field><value name="op_1"><block type="var_variable" id="tq@JoEdm:i-b[EK3f@kd"><field name="var_name">ta_height</field></block></value><value name="op_2"><block type="var_value" id="PbP:PvXXUrEM!nYrya)U"><field name="value">28</field></block></value></block></value><next><block type="set_var_to" id="w_[nP0:5H9Hr?,Z@+R94"><field name="var_name">ta_titlebar_width</field><value name="var_expr"><block type="var_math" id="{T^~ULxfg$O!RS`gEO#_"><field name="operator">subtract</field><value name="op_1"><block type="var_variable" id="TWU9i?rsh~~yqkMqVt}3"><field name="var_name">ta_width</field></block></value><value name="op_2"><block type="var_value" id="x|hV^zh!N%P=S7QmJc;e"><field name="value">20</field></block></value></block></value><next><block type="set_var_to" id="4v4Ob~-m-a(aE@,STbUN"><field name="var_name">ta_text_width</field><value name="var_expr"><block type="var_math" id="j{6+t$ii7[m+BUaa,x50"><field name="operator">subtract</field><value name="op_1"><block type="var_variable" id="SK*$jZ0yT3xI9m%0Lmt3"><field name="var_name">ta_width</field></block></value><value name="op_2"><block type="var_value" id="@@*X-iB;[vn?#O7~WyCF"><field name="value">16</field></block></value></block></value><next><block type="set_var_to" id="$K;:!+?qjcszB9VoE?zc"><field name="var_name">ta_text_height</field><value name="var_expr"><block type="var_math" id="pzdu_X=4nh!yJujAwH[|"><field name="operator">subtract</field><value name="op_1"><block type="var_variable" id="S_dD4w{Cbm%v{6MWlXo."><field name="var_name">ta_height</field></block></value><value name="op_2"><block type="var_value" id="n80/+EkNxZ:LifX{X)~x"><field name="value">62</field></block></value></block></value><next><block type="set_var_to" id="KwGgeu+7eSxz=%#]y+X)"><field name="var_name">ta_desc_width</field><value name="var_expr"><block type="var_math" id="t+,BK-:ph0mW4~hNR2;B"><field name="operator">subtract</field><value name="op_1"><block type="var_variable" id="Wt^w%Ii7#0~~9(e_8z-H"><field name="var_name">ta_width</field></block></value><value name="op_2"><block type="var_value" id=".wPyg6r7(dn2P{qj]5!$"><field name="value">82</field></block></value></block></value><next><block type="comment" id="lB8Hn3B]mU?%9)!*4qFL"><field name="comment">rejoin new swarms if needed</field><next><block type="if_then_else" id="HZ,_A}.FhI9r%2~fa;11"><field name="condition">"${swarm_connected}" == "true"</field><statement name="then"><block type="if_then_else" id="wh`03b,zgF}L:|9Jnyc-"><field name="condition">"${old_rec_swarm}" != "${ta_rec_swarm}"</field><statement name="then"><block type="swarm_leave" id="KbHRRV4jIP%.0n{tmMaa"><field name="topic">${old_rec_swarm}</field><next><block type="if_then_else" id="]V};*Zoe)P,;d^83d)G!"><field name="condition">"${ta_rec_swarm}" != ""</field><statement name="then"><block type="swarm_join" id="Wxnr8KiuvD$|j(npUWhB"><field name="topic">${ta_rec_swarm}</field><field name="alias">${pd_alias}</field><field name="webhook">swarm_hook</field><field name="seed"></field></block></statement></block></next></block></statement><next><block type="if_then_else" id="KKThaqRneor:~dl(6bu%"><field name="condition">"${old_send_swarm}" != "${ta_send_swarm}"</field><statement name="then"><block type="swarm_leave" id="BhBj1=1dB7_0zSr~vj*S"><field name="topic">${old_send_swarm}</field></block></statement><next><block type="if_then_else" id="7+E5c4P$S]Tuml89-,ev"><field name="condition">("${ta_send_swarm}" != "${ta_rec_swarm}") &amp;&amp; ("${ta_send_swarm}"!="")</field><statement name="then"><block type="swarm_join" id="@B_N]YdT!7i2-dbu(/h#"><field name="topic">${ta_send_swarm}</field><field name="alias">${pd_alias}</field><field name="webhook">publish_swarm_hook</field><field name="seed"></field></block></statement></block></next></block></next></block></statement></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement><next><block type="workflow_end" id="Ub?h9a`t,Etsd=M0U|uJ"></block></next></block></next></block></xml>